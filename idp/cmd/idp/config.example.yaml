# Dex configuration for NetBird embedded IDP
# Compatible with standard Dex configuration format

issuer: https://netbird.example.com/dex

storage:
  type: sqlite3
  config:
    file: /var/dex/dex.db

web:
  http: 0.0.0.0:5556

# gRPC API for user management (used by NetBird IDP manager)
grpc:
  addr: 0.0.0.0:5557

oauth2:
  skipApprovalScreen: true

# Static OAuth2 clients for NetBird
staticClients:
  # Dashboard client
  - id: netbird-dashboard
    name: NetBird Dashboard
    redirectURIs:
      - https://netbird.example.com/nb-auth
      - https://netbird.example.com/nb-silent-auth
    public: true

  # CLI client (public - uses PKCE)
  - id: netbird-cli
    name: NetBird CLI
    public: true
    redirectURIs:
      - http://localhost:53000/
      - http://localhost:54000/

# Enable password database for static users
enablePasswordDB: true

# Static users - add more users here as needed
# Generate password hash with: htpasswd -bnBC 10 "" YOUR_PASSWORD | tr -d ':\n'
staticPasswords:
  - email: "admin@example.com"
    hash: "hashed-password
    username: "admin"
    userID: "8ec9f38f-bb87-46ea-a5f1-fd041e7c728a"

# Optional: Add external identity provider connectors
# connectors:
#   - type: github
#     id: github
#     name: GitHub
#     config:
#       clientID: $GITHUB_CLIENT_ID
#       clientSecret: $GITHUB_CLIENT_SECRET
#       redirectURI: https://netbird.example.com/dex/callback
